<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>wrf_pipeline_tools’ Code Structure &mdash; wrf_pipeline_tools dev documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="prev" title="Examples" href="examples/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> wrf_pipeline_tools
          </a>
              <div class="version">
                dev
              </div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/index.html">Examples</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Code Structure</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#preprocessing">Preprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#postprocessing">Postprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#simulation">Simulation</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">wrf_pipeline_tools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>wrf_pipeline_tools Code Structure</li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="wrf_pipeline_tools-s-code-structure">
<h1>Code Structure<a class="headerlink" href="#wrf_pipeline_tools-s-code-structure" title="Permalink to this headline"></a></h1>
<p>This page briefly describes the wrf_pipeline_tools main components.</p>
<section id="preprocessing">
<h2>Preprocessing<a class="headerlink" href="#preprocessing" title="Permalink to this headline"></a></h2>
<p>
<code>run_wrf_pre_pipeline.sh</code> calls minor scripts to do all preprocessing 
needed before running WPS. The main script called by <code>run_wrf_pre_pipeline.py</code> is the ncl conversion
script to write out intermediate WPS files. This script also performs checks for
whether cesm data is needed from HPSS, whether the cesm data has been converted into
the format needed for WPS intermediate conversion, and whether WPS intermediate 
data has already been written. This script takes an argument &lt;nrun&gt; which
allows WRF intermediate conversion to be run in parallel. The WPS intermediate
conversion is submitted to the queue on cheyenne.
</p>
</section>

<section id="postprocessing">
<h2>Postprocessing<a class="headerlink" href="#postprocessing" title="Permalink to this headline"></a></h2>
<p>
<code>run_wrf_diag_pipeline.sh</code> calls all diagnostics oriented routines. 
This includes running TSTORMS, plotting output, appending new figures to <code>diagnostics.tex</code>, compiling the tex file, and uploading to google drive.
</p>
</section>

<section id="simulation">
<h2>Simulation<a class="headerlink" href="#simulation" title="Permalink to this headline"></a></h2>
<p>

<p>
<code>run_wrf_pipeline.sh</code> calls <code>run_wrf_pre_pipeline.py</code> and <code>run_wrf_batch.py</code> and runs the entire pipeline
from fetching cesm data from HPSS to converting cesm data to intermediate
format for WPS, to running WRF, and to extracting only the needed fields 
from WRF output for storm tracking and drought analysis. This script takes an
argument &lt;stride&gt; which selects how many parallel WRF sims to run. 
This script also includes all immediate post-processing routines on WRF output before sending to TSTORMS.
</p>

<p>
<code>run_wrf_batch.py</code> runs the entire WPS/WRF routine, including geogrid, metgrid,
real, and wrf. This script uses the templates seen in batch_templates to submit
jobs through PBS to cheyenne and setup namelists. These templates are edited upon 
running and copied into the required directories. This script also takes an 
argument &lt;nrun&gt; so that multiple WRF runs can happen simultaneously. On running 
WPS_nrun and WRF_nrun are created and routines are run from those directories.
</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="examples/index.html" class="btn btn-neutral float-left" title="Examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, the ECRL development team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>